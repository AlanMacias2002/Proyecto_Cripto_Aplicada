{% extends 'fa_base.html' %}
{% block content %}
  <h2>Tabla Administrativa</h2>
  <form method="get">
    <label>Evento: <input type="text" name="evento" value="{{ evento }}" /></label>
    <label>Hash: <input type="text" name="hash" value="{{ hash_val }}" /></label>
    <label>Entidad real: <input type="text" name="entidad_real" value="{{ entidad_real }}" /></label>
    <label>Fecha: <input type="text" name="fecha" value="{{ fecha }}" placeholder="YYYY-MM-DDTHH:MM:SSZ" /></label>
    <label>Desde: <input type="text" name="fecha_desde" value="{{ fecha_desde }}" placeholder="YYYY-MM-DDTHH:MM:SSZ" /></label>
    <label>Hasta: <input type="text" name="fecha_hasta" value="{{ fecha_hasta }}" placeholder="YYYY-MM-DDTHH:MM:SSZ" /></label>
    <input type="hidden" name="limit" value="{{ limit }}" />
    <button type="submit">Filtrar</button>
  </form>
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Hash</th>
        <th>Entidad Real</th>
        <th>Timestamp</th>
        <th>Nonce</th>
        <th>Evento</th>
        <th>Detalles</th>
      </tr>
    </thead>
    <tbody>
      {% for r in rows %}
      <tr>
        <td>{{ r.id }}</td>
        <td><code>{{ r.hash }}</code></td>
        <td>{{ r.entidad_real }}</td>
        <td>{{ r.timestamp }}</td>
        <td>{{ r.nonce }}</td>
        <td>{{ r.evento }}</td>
        <td>
          {{ r.detalles }}
          <div><a href="/ui/verify?hash={{ r.hash }}" class="btn">Verificar</a></div>
        </td>
      </tr>
      {% endfor %}
      {% if rows|length == 0 %}
      <tr><td colspan="7">Sin registros</td></tr>
      {% endif %}
    </tbody>
  </table>
  <div class="pager">
    <a href="?limit={{ limit }}&offset={{ prev_offset }}&evento={{ evento }}&hash={{ hash_val }}&entidad_real={{ entidad_real }}&fecha={{ fecha }}&fecha_desde={{ fecha_desde }}&fecha_hasta={{ fecha_hasta }}">Anterior</a>
    <a href="?limit={{ limit }}&offset={{ next_offset }}&evento={{ evento }}&hash={{ hash_val }}&entidad_real={{ entidad_real }}&fecha={{ fecha }}&fecha_desde={{ fecha_desde }}&fecha_hasta={{ fecha_hasta }}">Siguiente</a>
  </div>
{% endblock %}
